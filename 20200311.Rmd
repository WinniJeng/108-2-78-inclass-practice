---
title: '20200311'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.



##0318

```{r}
library(googlesheets4)
library(readr)
exDataPost80s <- read_csv("https://www.dropbox.com/s/rc6t40gsxduysz6/exDataPost80s.csv?dl=1")

```

```{r}
a <- 2
a = 2
`我的年紀`= 19
my_age <- `我的年紀`
b <- 3
a+b
```

```{r}
my_108_total_credits <- 15
_108_total_credits <- 15
108_total_credits <- 15
_my_108_total_credits <- 15
my.108.total_credits <- 15
.108.total_credits <- 15 # 隱藏變數
.my.108.total_credits <- 15
我的108學年總學分數 <- 15
`我的108學年總學分數` <- 15 # 特殊名稱處理，`不是名稱的一部份
`.108.total_credits` <- 15
```

```{r}
a <- 15
b <- a
```

```{r}
num1 <- 5
vNum1 <- c(2,5)
vNum2 <- c(2, num1)
```

```{r}
vNum1 <- c(-1,5)
vNum2 <- c(2,3)
vNum3 <- c(vNum1,vNum2)
vNum4 <- c(-1,5,2,3)
vNum5 <- c(c(-1,5),c(2,3))
```

```{r}
vNum1 <- c(-1,5)
vNum2 <- c(2,3)
vNum4 <- c() # 空向量
```

```{r}
vNum3 <- c(vNum2, vNum1)
vNum4 <- c(vNum4, vNum1) # 向量疊代 （recursive vector concatenate）
```

```{r}
dialogue1 <- c('小明說："明天不用上課。"',
               '小花說："真的嗎？"')

cat(dialogue, sep="\n")
```
```{r}
char1Vector<-c("你好","How are you?")
```

```{r}
library(httr)
library(dplyr)
GET("https://api.github.com/repos/tpemartin/108-2-56-inclass-practice/commits") %>%
  content() %>%
  View()
```
```{r}
dialogue2 <-c("小明說：'明天不用上課。'","小花說：'真的嗎？'")
cat(dialogue2, sep="\n")
```
```{r}
library(googlesheets4)
`出席狀況表單網址` <- 'https://docs.google.com/spreadsheets/d/1oB-5hj1pO5g8FMpZbA7RgIG8NvCRx6WvLPwvleCEV4Q/edit?usp=drive_open&ouid=118298788042510497005'
ss <- as_sheets_id(`出席狀況表單網址`)
homework_sheet <- sheets_read(ss,sheet=1)
```
```{r}
logi1 <- c(T,TRUE,F,FALSE,FALSE)
```

```{r}
num <- c(1.5, 2, 3)
int <- c(1L, 3L, -2L)
char <- c("1.5","2","3")
logi <- c(T,T,F)

typeof(num)
typeof(int)
typeof(char)
typeof(logi)
```

```{r}
library(readr)
A02_company_all_public <- read_csv("https://www.dropbox.com/s/rtz2a9na62n3a8l/A02_company_all_public.csv?dl=1")
A02_company_all_public$`候選人` -> candidate
```

```{r}
# 10位學生的主系
majors10_char <- c('經濟學系','社會學系','社會學系','經濟學系','經濟學系','社會學系','經濟學系','經濟學系','經濟學系','社會學系')

typeof(majors10_char)
class(majors10_char)
```

```{r}
majors10_factor <- factor(majors10_char)
# 或
majors10_factor <- factor(
  c('經濟學系','社會學系','社會學系','經濟學系','經濟學系','社會學系','經濟學系','經濟學系','經濟學系','社會學系')
)

typeof(majors10_factor)
class(majors10_factor)
```

```{r}
levels(majors10_factor)
```

```{r}
stringInteger <- c(1,2,-11)
class(stringInteger) # 無法進行數值運算
stringInteger+2
```

```{r}
stringInteger <- c("1","2","-11")
class(stringInteger) # 無法進行數值運算
numerstringInteger <- as.numeric(stringInteger)
numerstringInteger+2
```

```{r}
studentId <- c(410773002, 410773015)
charstudentId <-as.character(studentId)
class(studentId)
class(charstudentId)
```

```{r}
library(readr)
hello <- read_csv("https://www.dropbox.com/s/j5h23wqrlnuqkai/hello.csv?dl=1")
a <- "a"
`是在` <- c("哈樓","?")
number <- 0
numbers <- c(1:3,5)
fun <- function(){}
logic <- c(1==2,1!=1,1<=2)
class(number)
class(numbers)
typeof(number)
typeof(numbers)
```

```{r}
library(lubridate)
```
台北 2020-03-18 13:52:40
```{r}
tpeDateTime<-ymd_hms("2020-03-18 13:52:40",tz="Asia/Taipei")
tpeDateTime
```
葡萄牙 Mar.18, 2020, 05:52:40
```{r}
pgDateTime<-mdy_hms("葡萄牙 Mar.18, 2020, 05:52:40",tz="Europe/Lisbon")
pgDateTime
```

```{r}
with_tz(tpeDateTime, tzone="UTC")
with_tz(pgDateTime, tzone="UTC")
```

```{r}
browseURL("https://docs.google.com/spreadsheets/d/1EAG49qDKPWWi0ebkVr29TLrvVnoBPfkvxYY-J3xLAHY/edit#gid=458686645")
```

2020-03-04T06:56:29Z
```{r}
student1<-c(ymd_hms("2020-03-04T06:56:29Z"),
            ymd_hms("2020-03-11 14:16:43",tz=("Asia/Taipei")),
            ymd_hms("2020-03-11 14:34:33",tz=("Asia/Taipei")))
class(student1)
student1
```

```{r}
with_tz(student1,tzone = "Asia/Taipei")
```

```{r}
vectorExample <-c(2,6,7)
listExample <- list(2,6,7)

print(vectorExample)
print(listExample)
```

```{r}
c("2020-03-31T13:40:55Z",
  "一芳",
  "2",
  "水果茶")
library(lubridate)


list(ymd_hms("2020-03-31T13:40:55Z"),
  "一芳",
  2,
  "水果茶")


```

```{r}
c("108學年第1學期","高級會計學","高等統計學")
c("108學年第2學期",  "食在拉丁美洲")
```

```{r}
list(c("108學年第1學期","高級會計學","高等統計學"),
c("108學年第2學期",  "食在拉丁美洲"))
```

```{r}
# list含兩個vectors
`小明108學年課表A` <- list(
  c("108-1","高級會計學","高等統計學"),
  c("108-2","食在拉丁美洲")
)
print(`小明108學年課表A`)
```

```{r}
# list含兩個lists
`小明108學年課表B` <- list(
  list("108-1","高級會計學","高等統計學"),
  list("108-2","食在拉丁美洲")
)
print(`小明108學年課表B`)
```


```{r}
# list含兩個lists, 子層list又各含兩個vectors
`小明108學年課表C` <- list(
  list(
    c("108-1"), # 可只寫 "108-1"
    c("高級會計學","高等統計學")
       ),
  list(
    c("108-2"),
    c("食在拉丁美洲")
  )
)
print(`小明108學年課表C`)
```


```{r}
`小明108學年課表C` <- list(
  `上學期` = list(
    semester = c("108-1"), # 可只寫 "108-1"
    courses = c("高級會計學","高等統計學")
       ),
  `下學期` = list(
    semester = c("108-2"),
    courses = c("食在拉丁美洲")
  )
)
print(`小明108學年課表C`)
```

```{r}
commit <- list(
  author = list(
    name= "Martin老師",
   email="mtlin@gm.ntpu.edu.tw",
   time= ymd_hms("2020-03-25T07:17:40Z")),
  committer = list(
    name= "emilyluckey",
    email="emily007@gmail.com",
    time= ymd_hms("2020-03-26T08:18:40Z")),
  message ="update"
)
print(commit)
```


```{r}
browseURL("https://api.github.com/repos/tpemartin/108-2-56-inclass-practice/commits") 
```

```{r}
library(jsonlite) # 不少同學這行會有Error，還記得如何排除嗎？
toJSON(commit)
```

```{r}
learning <-list(
  student = "小明",
  `1` = list(
    semester= "108-1",
    teacher = c("Alice老師","Mark老師"),
    class = c("個體經濟學","總體經濟學"),
    score = c("85","73")),
  
    `2` = list(
      semester = "108-2",
      teacher = "Jason老師",
      class = "作業研究",
      score= "90"
    )
)

print(learning)
```

```{r}
# 108-1 
course1_1081 <- 
  list(
    name="個體經濟學",
    teacher="Alice",
    grade=85
  )
course2_1081 <-
  list(
    name="總體經濟學",
    teacher="Mark",
    grade=78
  )
`108-1修課記錄` <- 
  list(
    course1_1081,
    course2_1081
  )

# 108-2
course1_1082 <- 
  list(
    name="作業研究",
    teacher="Jason",
    grade=90
  )
`108-2修課記錄` <- 
  list(
    course1_1082
  )

# 整合兩學期
`每學期修課記錄` <- list(
  `108-1`=`108-1修課記錄`,
  `108-2`=`108-2修課記錄`
)

# 完成記錄
`小明的修課記錄` <- 
  list(
    name="小明",
    semesters=`每學期修課記錄`
  )
```

```{r}
weather <-list(
  `2020-03-31`=list(
    city = "台北市",
    `high temperture` = 25,
    `low temperture` = 18
  ),
  `2020-04-01` = list(
    city = "新北市",
    `high temperture` = 24,
    `low temperture` = 15
  )
)

print(weather)
```

```{r}
`今明氣象預報` <- list(
  date = c(ymd("2020-03-31"),ymd("2020-04-01")),
  `台北市` = list(
    `high temperture` = 25,
    `low temperture` = 18
  ),
  `新北市` = list(
    `high temperture` = 24,
    `low temperture` = 15
  )
)

print(`今明氣象預報`)
```

```{r}
`台北市預報元素值` <- 
  list(
    city="台北市",
    high=25,
    low=18
  )
`新北市預報元素值` <- 
  list(
    city="新北市",
    high=24,
    low=15
  )

`各地預報元素值` <-
  list(
    `台北市預報`=`台北市預報元素值`,
    `新北市預報`=`新北市預報元素值`
  )

library(lubridate)
`今明天氣` <-
  list(
    `今天日期`=ymd("2020-03-31"),
    `明天天氣`=ymd("2020-04-01"),
    `各地預報`=`各地預報元素值`
  )
```





```{r}
save(commit,listExample,file = "today.Rda")
```


```{r}
load("today.Rda")
```


```{r}
vectorExample<-c("小明","小英","大雄")
length(vectorExample)
```

```{r}
vectorExample[[1]]
vectorExample[[3]]
vectorExample[[2]]
```


```{r}
listExample <- 
  list(
    student="小明",
    `學期`=list(
      `108-1`=list(
        list(
          name="個體經濟學",
          teacher="Alice",
          grade=85
        )
      ),
      `108-2`=list(
        list(
          name="總體經濟學",
          teacher="Mark",
          grade=78
        )
      )
    )
  )
# 有多少位置可選：
length(listExample)
```

```{r}
listExample[[1]]
listExample[[2]]
```

```{r}
library(jsonlite)
fromJSON("https://data.tainan.gov.tw/dataset/4cd9345a-04bf-4328-a97d-314ff78b4763/resource/afc025fc-1ef4-447c-b785-a680391d0ca1/download/tnsport2.json", simplifyDataFrame = F) -> tainanSportsMap

length(tainanSportsMap)
```

```{r}
tainanSportsMap[[1]]
tainanSportsMap[[1076]]
```

```{r}
names(listExample)
```

```{r}
listExample$student
listExample$`學期`
```

```{r}
fromJSON("http://data.ntpc.gov.tw/api/v1/rest/datastore/382000000A-000157-002",
         simplifyDataFrame = F) -> newTaipeiCityVaccine
```

```{r}
str(newTaipeiCityVaccine)
length(newTaipeiCityVaccine)
names(newTaipeiCityVaccine)
```

```{r}
str(newTaipeiCityVaccine[[1]])
str(newTaipeiCityVaccine$success)
str(newTaipeiCityVaccine[["success"]])

str(newTaipeiCityVaccine[[2]], max.level = 1)
str(newTaipeiCityVaccine$result, max.level = 1)
str(newTaipeiCityVaccine[["result"]], max.level = 1)
```


```{r}
vectorExample
vectorExample[c(1,3)]
vectorExample[c(3,2,1)] # 產生重新排列效果
```

```{r}
# 顯示到第一層
str(listExample, max.level=1)

str(listExample[c(1,2)], max.level = 1)
```

```{r}
#str(tainanSportsMap, max.level = 1)
#str(tainanSportsMap[c(1,2,66)], max.level = 1)
tainanSportsMap

```

```{r}
str(listExample, max.level = 1)

listExample[c("student","學期")]
listExample[c("學期","student")]
```

```{r}
fromJSON("https://www.dropbox.com/s/qnm9bnz7vccrvcz/taipeiNightMarkets.json?dl=1", simplifyDataFrame = F) -> taipeiNightMarkets
```

```{r}
names(taipeiNightMarkets)
taipeiNightMarkets[c("寧夏觀光夜市","華西觀光夜市")]
```

```{r}
vectorExample
vectorExample[c(T,T,F)] # 要，要，不要
```

```{r}
str(listExample[c(F,T)]) # 不要，要
str(listExample[c(T,T)]) # 要，要
```

```{r}
names(taipeiNightMarkets)

c(T,F,
  F,F,
  T,F,
  F,F,
  F,T,
  F,F,
  F,T) ->selectedMarkets

taipeiNightMarkets[selectedMarkets]

str(taipeiNightMarkets[c(T,F,
  F,F,
  T,F,
  F,F,
  F,T,
  F,F,
  F,T)], max.level = 1)
```


```{r}
selectedMarkets <- rep(F,14) #repeat F 14次
print(selectedMarkets)
selectedMarkets[c(1,5,10,14)] <- TRUE
selectedMarkets
```

```{r}
str(taipeiNightMarkets[selectedMarkets], max.level = 1)
```

```{r}
str(listExample,max.level = 3)
```

```{r}
get1 <- listExample[["學期"]]
get2 <- listExample["學期"]
```

```{r}

str(listExample,max.level = 3)
```


```{r}
str(get1, max.level = 1)
```

```{r}
str(get2, max.level = 1)
```

```{r}
numVector <- c(2,3,6,-1,4,2,6)
select1 <- numVector[c(1,4)]; select1
select2 <- select1[[1]]; select2

# 相當於
numVector[c(1,4)][[1]]
```

```{r}
select1 <- numVector[c(T,T,F,T,F,F,T)]; select1
select2 <- select1[c(1,4)]; select2

# 相當於
numVector[c(T,T,F,T,F,F,T)][c(1,4)] #選前面的1,4項
```

```{r}
majors <- c("經濟學系","經濟學系","社會學系","社工系","經濟學系")
names <- c("小英", "小美", "大雄","阿華", "阿尼")
gender <- c("F","F","M","F","M")
```





























